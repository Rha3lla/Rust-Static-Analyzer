[mapping]
#version of THIS mapping schema (not the tool version)
schema_version = "0.1"

# MISRA source reference (human readable, not legal copy)
misra_source = "MISRA C:2025 Addendum 6 (Applicability to Rust)"

# when this mapping was last meaningfully updated
last_updated = "2026-02-19"

# notes about scope/interpretation
notes = """
This file defines explicit mappings between HA-RUST rules and MISRA guidelines that are
applicable to Rust. The tool uses these mappings for compliance reporting and filtering. 
"""

# Per-rule mappings

[[rule]]
id = "HA-RUST-001"
title = "Unjustified unsafe block"
default_severity = "error"

# applicability mode for MISRA reporting
# from the doc: rust_general | safe_rust | both | not_applicable
misra_applicability = "rust_general"

#reporting categories
# from the doc: required | advisory | n_a
misra_category = "required"

# references -- keeping as strings for flexibility
# example: "MISRA-C:2025-Add6 <table-row-id>"
misra_refs = [
"MISRA-C:2025 Add6 <TBD>"
]

# mapping strength -- optional for now, might be implemented later
# options: direct | partial | derived | heuristic
# mapping_strength = "direct"

# CWE references for traceability
cwe = ["CWE-119"]

# placeholder for repo references/evidence (docs, implementation, tests)
#doc_path = "docs/rules/HA-RUST-0001.md"
#impl_path = "crates/ha_lint_core/src/rules/unsafe.rs"
#test_path = ["tests/fixtures/unsafe/ha_rust_0001.rs"

# notes for humans
notes = """
example: Requires an associated SAFETY justification per policy. Enforced conservatively.
"""
